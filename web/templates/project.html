{% extends 'base.html' %}

{% block title %}{{ project.name if project else 'Project' }} - MV Internal{% endblock %}

{% block content %}
<div class="project-header">
    <div class="project-header-top">
        <a href="/projects" class="project-back" title="Back to projects">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
        </a>
        <div class="project-color-lg" id="projectColor"></div>
        <h1 class="project-title" id="projectTitle">Loading...</h1>
        <div class="project-actions">
            <button class="project-action-btn" data-action="open-edit-modal" title="Edit project">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
            </button>
            <div class="dropdown">
                <button class="project-action-btn" data-action="toggle-dropdown" data-target-id="dropdownMenu" title="More options">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>
                </button>
                <div class="dropdown-menu" id="dropdownMenu">
                    <button class="dropdown-item danger" data-action="delete-project">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                        Delete project
                    </button>
                </div>
            </div>
        </div>
    </div>
    <p class="project-description" id="projectDescription"></p>
</div>

<div class="project-body">
    <div class="project-section-header">
        <h2 class="project-section-title">Chats</h2>
    </div>
    <div class="project-conversations" id="projectConversations">
        <!-- Conversations loaded via JavaScript -->
    </div>
</div>
{% endblock %}

{% include '_dropdown_menu.html' %}

<!-- Edit Project Modal -->
<div class="modal-overlay" id="editModal" data-action="close-edit-modal">
    <div class="modal">
        <div class="modal-header">
            <h2 class="modal-title">Edit project</h2>
            <button class="modal-close" data-action="close-edit-modal">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label class="form-label">Name</label>
                <input type="text" class="form-input" id="editProjectName">
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-input" id="editProjectDesc"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Custom Instructions (for AI)</label>
                <textarea class="form-input" id="editProjectInstructions" placeholder="Give the AI context about this project..."></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Color</label>
                <div class="color-picker" id="editColorPicker">
                    <div class="color-option" style="background: #d97757" data-color="#d97757"></div>
                    <div class="color-option" style="background: #e5a336" data-color="#e5a336"></div>
                    <div class="color-option" style="background: #7cb342" data-color="#7cb342"></div>
                    <div class="color-option" style="background: #26a69a" data-color="#26a69a"></div>
                    <div class="color-option" style="background: #42a5f5" data-color="#42a5f5"></div>
                    <div class="color-option" style="background: #5c6bc0" data-color="#5c6bc0"></div>
                    <div class="color-option" style="background: #ab47bc" data-color="#ab47bc"></div>
                    <div class="color-option" style="background: #ec407a" data-color="#ec407a"></div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" data-action="close-edit-modal">Cancel</button>
            <button class="btn btn-primary" data-action="save-project">Save changes</button>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    // Set PROJECT_ID for external script
    window.PROJECT_ID = '{{ project_id }}';
</script>
<script src="{{ url_for('static', filename='js/project.js') }}"></script>
{% endblock %}
